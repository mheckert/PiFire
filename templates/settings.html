{% extends 'base.html' %}
{% from '_macro_settings.html' import render_controller_config %}

{% block cssextend %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap-colorpicker.min.css') }}" type="text/css" />
{% endblock %}

{% block title %}Settings{% endblock %}

{% block notify %}
<!-- Settings Success -->
{% if (alert['type'] == "updated") %}
<br>
<div class="alert alert-success alert-dismissible">
    <button type="button" class="close" data-dismiss="alert">&times;</button>
    <b>
        <i class="far fa-check-circle"></i>&nbsp; {{ alert['text'] }}
    </b>
</div>
{% elif (alert['type'] == "warning") %}
<br>
<div class="alert alert-warning alert-dismissible">
    <button type="button" class="close" data-dismiss="alert">&times;</button>
    <b>
        <i class="far fa-exclamation-circle"></i>&nbsp; {{ alert['text'] }}
    </b>
</div>
{% elif (alert['type'] == "error") %}
<br>
<div class="alert alert-danger alert-dismissible">
    <button type="button" class="close" data-dismiss="alert">&times;</button>
    <b>
        <i class="fas fa-bomb"></i>&nbsp; {{ alert['text'] }}
    </b>
</div>
{% endif %}
{% endblock %}

{% block content %}
<input type="hidden" id="units" name="units" value="{{ settings['globals']['units'] }}">
<br>
<div class="row">
    {% if not request.MOBILE %}
    <div class="col-3">
        <!-- Side Navigation Row -->
        <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
            <a class="nav-link active" id="v-pills-probes-tab" data-toggle="pill" href="#v-pills-probes" role="tab" aria-controls="v-pills-probes" aria-selected="true">Probe Settings</a>
            <a class="nav-link" id="v-pills-probe-profiles-tab" data-toggle="pill" href="#v-pills-probe-profiles" role="tab" aria-controls="v-pills-probe-profiles" aria-selected="false">Probe Profiles</a>
            <a class="nav-link" id="v-pills-units-tab" data-toggle="pill" href="#v-pills-units" role="tab" aria-controls="v-pills-units" aria-selected="false">Units</a>
            <a class="nav-link" id="v-pills-name-tab" data-toggle="pill" href="#v-pills-name" role="tab" aria-controls="v-pills-name" aria-selected="false">Grill Name</a>
            <a class="nav-link" id="v-pills-work-mode-tab" data-toggle="pill" href="#v-pills-work-mode" role="tab" aria-controls="v-pills-work-mode" aria-selected="false">Work Mode</a>
            {% if settings['globals']['dc_fan'] %}
            <a class="nav-link" id="v-pills-pwm-tab" data-toggle="pill" href="#v-pills-pwm" role="tab" aria-controls="v-pills-pwm" aria-selected="false">PWM Settings</a>
            {% endif %}
            <a class="nav-link" id="v-pills-timers-tab" data-toggle="pill" href="#v-pills-timers" role="tab" aria-controls="v-pills-timers" aria-selected="false">Startup & Shutdown</a>
            <a class="nav-link" id="v-pills-dash-tab" data-toggle="pill" href="#v-pills-dash" role="tab" aria-controls="v-pills-dash" aria-selected="false">Dashboard</a>
            <a class="nav-link" id="v-pills-history-tab" data-toggle="pill" href="#v-pills-history" role="tab" aria-controls="v-pills-history" aria-selected="false">History</a>
            <a class="nav-link" id="v-pills-safety-tab" data-toggle="pill" href="#v-pills-safety" role="tab" aria-controls="v-pills-safety" aria-selected="false">Safety</a>
            <a class="nav-link" id="v-pills-pellets-tab" data-toggle="pill" href="#v-pills-pellets" role="tab" aria-controls="v-pills-pellets" aria-selected="false">Pellets</a>
            <a class="nav-link" id="v-pills-theme-tab" data-toggle="pill" href="#v-pills-theme" role="tab" aria-controls="v-pills-theme" aria-selected="false">Theme</a>
            <a class="nav-link" id="v-pills-notifications-tab" data-toggle="pill" href="#v-pills-notifications" role="tab" aria-controls="v-pills-notifications" aria-selected="false">Notifications</a>
        </div>
    </div>
    {% endif %}
    <div class="{% if request.MOBILE %}col-12{% else %}col-9{% endif %}">
        <!-- ============================ Probe Settings =============================== -->
        <div class="tab-content" id="v-pills-tabContent">
            <div class="tab-pane fade show active" id="v-pills-probes" role="tabpanel" aria-labelledby="v-pills-probes-tab">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h5>
                            <i class="fas fa-thermometer"></i>&nbsp; Probe Settings
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="card shadow">
                            <div class="card-header">
                                <h5>
                                    <i class="fa fa-tools"></i>&nbsp; Probe Types
                                </h5>
                            </div>
                            <div class="card-body">
                                <!-- Probe Settings Form Start -->
                                <form name="probe_type_input" id="probe_form" action="/settings/probes" method="POST">
                                    {% for probe in settings['probe_settings']['probe_map']['probe_info'] %}
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">{{ probe['name'] }} Profile Selection</span>
                                        </div>
                                        <select class="form-control" name="profile_select_{{ probe['label'] }}" id="profile_select_{{ probe['label'] }}" onchange="this.form.submit()">
                                            {% for index, data in settings['probe_settings']['probe_profiles'].items()|sort %}
                                            {% if data['id'] == probe['profile']['id'] %}
                                            <option value="{{ index }}" selected>{{ data['name'] }}</option>
                                            {% else %}
                                            <option value="{{ index }}">{{ data['name'] }}</option>
                                            {% endif %} {% endfor %}
                                        </select>
                                    </div>
                                    {% endfor %}
                                </form>
                            </div><!-- End of card body -->
                        </div><!-- End of Probe Types Card -->
                        <br>
                        <div class="card shadow">
                            <form name="probe_name_input" id="probe_form" action="/settings/probes" method="POST">
                                <div class="card-header">
                                    <h5>
                                        <i class="fa fa-tools"></i>&nbsp; Probe Display Names 
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <!-- Probe Settings Form Start -->

                                        {% for probe in settings['probe_settings']['probe_map']['probe_info'] %}
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Probe name displayed by PiFire on the Dashboard and Graphs">
                                                {{ probe['name'] }} &nbsp;<i class="fas fa-arrow-right"></i></span>
                                            </div>
                                            <input id="probe_name_{{ probe['label'] }}" type="text" class="form-control" name="probe_name_{{ probe['label'] }}" value="{{ probe['name'] }}">
                                        </div>
                                        {% endfor %}
                                    
                                </div> <!-- -->
                                <div class="card-footer bg-light">
                                    <button type="submit" class="btn btn-outline-primary">Save</button>
                                </div>
                            </form>
                        </div> <!-- End of card for Probe Display Names -->
                    </div><!-- End of Probe Settings Card body -->
                </div><!-- End of Probe Settings Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ============================ Edit / Add / Delete Probe Profiles ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-probe-profiles" role="tabpanel" aria-labelledby="v-pills-probe-profiles-tab">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h5>
                            <i class="fas fa-edit"></i>&nbsp; Probe Profile Editor
                        </h5>
                    </div>
                    <div class="card-body">
                        {% for index, data in settings['probe_settings']['probe_profiles'].items()|sort %}
                        <div class="card shadow">
                            <form name="editprofile" action="/settings/editprofile" method="POST">
                                <div class="card-header bg-light text-dark">
                                    <h5>
                                        <a href="#edit{{ index }}" data-toggle="collapse">
                                            <i class="far fa-caret-square-down"></i>&nbsp; {{ data['name'] }}</a>
                                    </h5>
                                </div>
                                <div id="edit{{ index }}" class="collapse">
                                    <div class="card-body">
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Human readable name for profile. Used to display above.">
                                                    <i class="fas fa-user-circle"></i>&nbsp; Name </span>
                                            </div>
                                            <input id="Name_{{ index }}" type="text" class="form-control" name="Name_{{ index }}" value="{{ data['name'] }}">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Source Voltage (volts)">
                                                    <i class="fas fa-bolt"></i>&nbsp; Vs </span>
                                            </div>
                                            <input id="Vs_{{ index }}" type="text" class="form-control" name="Vs_{{ index }}" value="{{ data['Vs'] }}">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="R1 in resistor divider (ohms)">
                                                    <i class="fas fa-divide"></i>&nbsp; Rd </span>
                                            </div>
                                            <input id="Rd_{{ index }}" type="text" class="form-control" name="Rd_{{ index }}" value="{{ data['Rd'] }}">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Coefficient A in Steinhart Hart Calculation">
                                                    <i class="fas fa-calculator"></i>&nbsp; CoEff A </span>
                                            </div>
                                            <input id="A_{{ index }}" type="text" class="form-control" name="A_{{ index }}" value="{{ data['A'] }}">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Coefficient B in Steinhart Hart Calculation">
                                                    <i class="fas fa-calculator"></i>&nbsp; CoEff B </span>
                                            </div>
                                            <input id="B_{{ index }}" type="text" class="form-control" name="B_{{ index }}" value="{{ data['B'] }}">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Coefficient C in Steinhart Hart Calculation">
                                                    <i class="fas fa-calculator"></i>&nbsp; CoEff C </span>
                                            </div>
                                            <input id="C_{{ index }}" type="text" class="form-control" name="C_{{ index }}" value="{{ data['C'] }}">
                                        </div>
                                    </div>
                                    <div class="card-footer bg-light">
                                        <button type="submit" class="btn btn-primary" name="editprofile" value="{{ index }}">Save</button>
                                        <!-- Button to Open the Modal -->
                                        <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#DeleteProfileModal{{ index }}">Delete</button>
                                        <!-- The Modal -->
                                        <div class="modal" id="DeleteProfileModal{{ index }}">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <!-- Modal Header -->
                                                    <div class="modal-header">
                                                        <h4 class="modal-title">Delete Profile {{ data['name'] }}</h4>
                                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                    </div>
                                                    <!-- Modal body -->
                                                    <div class="modal-body"> Are you sure you want to delete the {{ data['name'] }} profile?</div>
                                                    <!-- Modal footer -->
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                        <button type="submit" class="btn btn-danger" name="delete" value="{{ index }}">Delete</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <br>
                        {% endfor %}
                        <a href="/tuning" class="btn btn-outline-primary btn-block shadow" role="button"><i class="fas fa-toolbox"></i> Tune Probe Coefficients Tool </a>
                        <br>
                        <div class="card shadow">
                            <form name="addprofile" action="/settings/addprofile" method="POST">
                                <div class="card-header bg-light text-dark">
                                    <h5>
                                        <a href="#addprofile" data-toggle="collapse">
                                            <i class="fas fa-plus-circle"></i>&nbsp; Add Profile </a>
                                    </h5>
                                </div>
                                <div id="addprofile" class="collapse">
                                    <div class="card-body">
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Human readable name for profile. Used to display above.">
                                                    <i class="fas fa-user-circle"></i>&nbsp; Name </span>
                                            </div>
                                            <input id="Name" type="text" class="form-control" placeholder="Name" name="Name">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Source Voltage (volts)">
                                                    <i class="fas fa-bolt"></i>&nbsp; Vs </span>
                                            </div>
                                            <input id="Vs" type="text" class="form-control" value="3.28" name="Vs">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="R1 in resistor divider (ohms)">
                                                    <i class="fas fa-divide"></i>&nbsp; Rd </span>
                                            </div>
                                            <input id="Rd" type="text" class="form-control" value="10000" name="Rd">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Coefficient A in Steinhart Hart Calculation">
                                                    <i class="fas fa-calculator"></i>&nbsp; CoEff A </span>
                                            </div>
                                            <input id="A" type="text" class="form-control" name="A">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" data-toggle="tooltip" title="Coefficient B in Steinhart Hart Calculation">
                                                    <i class="fas fa-calculator"></i>&nbsp; CoEff B </span>
                                            </div>
                                            <input id="B" type="text" class="form-control" name="B">
                                        </div>
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend"><span class="input-group-text" data-toggle="tooltip" title="Coefficient C in Steinhart Hart Calculation">
                                                <i class="fas fa-calculator"></i>&nbsp; CoEff C </span>
                                            </div>
                                            <input id="C" type="text" class="form-control" name="C">
                                        </div>
                                    </div>
                                    <div class="card-footer bg-light">
                                        <button type="submit" class="btn btn-outline-primary">Save</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div><!-- End of card body -->
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ============================ Select Temp Units ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-units" role="tabpanel" aria-labelledby="v-pills-units-tab">
                <div class="card shadow">
                    <form name="Units" action="/settings/units" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-temperature-low"></i>&nbsp; Select Units
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label for="selectUnits">Select temperature units to be used
                                    globally:</label>
                                <select class="form-control" id="selectUnits" name="units">
                                    <option value="F" {% if settings['globals']['units'] == 'F' %}selected{% endif %}>Fahrenheit (F)</option>
                                    <option value="C" {% if settings['globals']['units'] == 'C' %}selected{% endif %}>Celsius (C)</option>
                                </select>
                            </div>
                            <span class="badge badge-warning">NOTE:</span>
                            <i class="small"> Changing the scale/units will restart the grill controller (stopping any currently running modes) and automatically erase history. </i>
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ============================ Grill Name ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-name" role="tabpanel" aria-labelledby="v-pills-name-tab">
                <div class="card shadow">
                    <form name="GrillName" action="/settings/grillname" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-file-signature"></i>&nbsp; Grill Name
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" data-toggle="tooltip" title="Choose a name for your grill!">
                                        <i class="fas fa-user-ninja"></i>&nbsp; Grill Name </span>
                                </div>
                                <input id="grill_name" type="text" class="form-control" placeholder="{{ settings['globals']['grill_name'] }}" value="{{ settings['globals']['grill_name'] }}" name="grill_name">
                            </div>
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ============================ Work Mode Settings ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-work-mode" role="tabpanel" aria-labelledby="v-pills-work-mode-tab">
                <div class="card shadow">
                    <form name="cycle_settings" action="/settings/cycle" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-tools"></i>&nbsp; Work Mode Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-play"></i>&nbsp; Startup / Smoke Mode Cycle Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Auger-On Time for Smoke / Startup (seconds)[Default=15]">
                                                <i class="far fa-clock"></i>&nbsp; Auger On Time
                                            </span>
                                        </div>
                                        <input id="smokecycletime" type="number" min="1" class="form-control" placeholder="{{ settings['cycle_data']['SmokeCycleTime'] }}" value="{{ settings['cycle_data']['SmokeCycleTime'] }}" name="smokecycletime">
                                    </div>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> More information about the PMode can be found <a href="http://tipsforbbq.com/Definition/Traeger-P-Setting" target="blank">here.</a> P-Mode is used for both Startup and Smoke modes, but not Hold mode. </i>
                                    <br>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="(Auger-Off Time: Set P-Mode for Smoke Cycle (1-10)">
                                                <i class="fas fa-cog"></i>&nbsp; P-Mode
                                            </span>
                                        </div>
                                        <input id="pmode" type="number" min="0" max="9" class="form-control" placeholder="{{ settings['cycle_data']['PMode'] }}" value="{{ settings['cycle_data']['PMode'] }}" name="pmode">
                                    </div>
                                    <table class="table table-bordered">
                                        <thead class="thead-light">
                                            <tr>
                                                <th>P-Mode</th>
                                                <th>Auger ON Time</th>
                                                <th>Auger OFF Time</th>
                                            </tr>
                                        </thead>
                                        {% for row in range(10) %}
                                        <tbody>
                                        {% if row == settings['cycle_data']['PMode'] %}
                                        <tr class="table-warning">
                                            {% else %}
                                        <tr>
                                            {% endif %}
                                            <td>{{ row }} {% if (row == 2) %}(Factory Default){% endif %}</td>
                                            <td>{{ settings['cycle_data']['SmokeCycleTime'] }}</td>
                                            <td>{{ (row * 10)+45 }} seconds</td>
                                        </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                    <br>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-fan"></i>&nbsp; Smoke Plus Settings (SMOKE & HOLD Mode) [Fan Cycling]
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small">Smoke Plus Mode can be toggled on/off by tapping the fan icon button on the dashboard. The icon will be highlighted blue indicating that smoke plus is enabled. Smoke Plus will cycle the fan on and off during smoke and hold mode to promote additional smoke generation. Fan cycling will only occur between the below min/max temperatures.</i>
                                    <br>
                                    <br>
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="default_smoke_plus" name="default_smoke_plus" {% if settings['smoke_plus']['enabled'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="default_smoke_plus">Smoke Plus Enabled by Default</label>
                                    </div>
                                    <br>
                                    {% if settings['globals']['dc_fan'] %}
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small">Fan Ramping will ramp the fan from off to the desired duty cycle instead of just turning on to full speed during Smoke Plus cycling. You can control the ramp duration by setting the Fan ON Time below. The desired duty cycle can also be set below.</i>
                                    <br>
                                    <br>
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="sp_fan_ramp" name="sp_fan_ramp" {% if settings['smoke_plus']['fan_ramp'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="sp_fan_ramp">Fan Ramping Enabled</label>
                                    </div>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Duty cycle that will be used during fan ramping (percent) [Default: 75]">
                                                <i class="far fa-clock"></i>&nbsp; Ramp Duty Cycle (%)
                                            </span>
                                        </div>
                                        <input id="sp_duty_cycle" type="number" min="20" max="100" class="form-control" placeholder="{{ settings['smoke_plus']['duty_cycle'] }}" value="{{ settings['smoke_plus']['duty_cycle'] }}" name="sp_duty_cycle">
                                    </div>
                                    {% endif %}
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Number of seconds the fan will remain ON during fan cycling (seconds) [Default: 5]">
                                                <i class="far fa-clock"></i>&nbsp; Fan ON Time (s)
                                            </span>
                                        </div>
                                        <input id="sp_on_time" type="number" min="sp_fade_in.value" class="form-control" placeholder="{{ settings['smoke_plus']['on_time'] }}" value="{{ settings['smoke_plus']['on_time'] }}" name="sp_on_time">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Number of seconds the fan will remain OFF during fan cycling (seconds) [Default: 5]">
                                                <i class="far fa-clock"></i>&nbsp; Fan OFF Time (s)
                                            </span>
                                        </div>
                                        <input id="sp_off_time" type="number" min="1" class="form-control" placeholder="{{ settings['smoke_plus']['off_time'] }}" value="{{ settings['smoke_plus']['off_time'] }}" name="sp_off_time">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Lowest temperature for Smoke Plus to operate. ({{settings['globals']['units']}}) [Default: 160F/71C]">
                                                <i class="fas fa-temperature-high"></i>&nbsp; Min Operational Temp ({{settings['globals']['units']}})
                                            </span>
                                        </div>
                                        <input id="sp_min_temp" type="number" min="1" class="form-control" placeholder="{{ settings['smoke_plus']['min_temp'] }}" value="{{ settings['smoke_plus']['min_temp'] }}" name="sp_min_temp">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Highest temperature for Smoke Plus to operate. ({{settings['globals']['units']}}) [Default: 220F/104C]">
                                                <i class="fas fa-temperature-high"></i>&nbsp; Max Operational Temp ({{settings['globals']['units']}})
                                            </span>
                                        </div>
                                        <input id="sp_max_temp" type="number" min="1" class="form-control" placeholder="{{ settings['smoke_plus']['max_temp'] }}" value="{{ settings['smoke_plus']['max_temp'] }}" name="sp_max_temp">
                                    </div>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-microchip"></i>&nbsp; Controller Configuration (HOLD Mode)
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label for="selectController"><i>Selected Controller Type:</i></label>
                                        <select class="form-control" id="selectController" name="selectController">
                                            {% for controller in controller_metadata %}
                                                <option value="{{ controller }}" {% if settings['controller']['selected'] == controller %}selected{% endif %}>{{ controller_metadata[controller]['friendly_name'] }}</option>
                                            {% endfor %}    
                                        </select>
                                    </div>
                                    <div id="controller_config">
                                        {{ render_controller_config(settings['controller']['selected'], controller_metadata, settings['controller'], settings['cycle_data']) }}
                                    </div>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>

                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-door-open"></i>&nbsp; Lid Open Detection Settings (HOLD Mode)
                                    </h5>
                                </div>
                                <div class="card-body">
                                    If enabled, the system will attempt to determine if the lid was opened and temporarily suspend the controller.  
                                    If the temperature drops below the threshold (percentage of the hold temperature), a lid open event is triggered.  
                                    Once lid open is detected, it will pause the controller calculations for the specified amount of seconds. <br>
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="lid_open_detect_enable" name="lid_open_detect_enable" {% if settings['cycle_data']['LidOpenDetectEnabled'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="lid_open_detect_enable">Auto Lid Open Detection</label>
                                    </div>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Percentage of hold set temperature threshold to trigger lid open detection.">
                                                <i class="fas fa-percent"></i>&nbsp; Lid Open Threshold Percentage
                                            </span>
                                        </div>
                                        <input id="lid_open_threshold" type="number" min="1" step="1" max="80" class="form-control" placeholder="{{ settings['cycle_data']['LidOpenThreshold'] }}" value="{{ settings['cycle_data']['LidOpenThreshold'] }}" name="lid_open_threshold">
                                    </div>

                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Time in seconds to pause the controller when lid open detected.">
                                                <i class="fas fa-clock"></i>&nbsp; Lid Open Pause Time (s)
                                            </span>
                                        </div>
                                        <input id="lid_open_pausetime" type="number" min="10" step="1" max="1000" class="form-control" placeholder="{{ settings['cycle_data']['LidOpenPauseTime'] }}" value="{{ settings['cycle_data']['LidOpenPauseTime'] }}" name="lid_open_pausetime">
                                    </div>

                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-tachometer-alt"></i>&nbsp; Keep Warm Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small">The Keep Warm function will be activated when option is selected and a probe set point has been achieved or the set timer has expired. The Grill will exit the currently running mode and switch to Hold Mode then attempt to maintain the temperature set below. You can also enable or disable the Smoke Plus feature during Keep Warm.</i>
                                    <br>
                                    <br>
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="keep_warm_s_plus" name="keep_warm_s_plus" {% if settings['keep_warm']['s_plus'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="keep_warm_s_plus">Smoke Plus Enabled</label>
                                    </div>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Keep Warm Temperature ({{settings['globals']['units']}}) [Default: 165F/74C]">
                                                <i class="fas fa-temperature-high"></i>&nbsp; Keep Warm Temp ({{settings['globals']['units']}})
                                            </span>
                                        </div>
                                        <input id="keep_warm_temp" type="number" min="1" class="form-control" placeholder="{{ settings['keep_warm']['temp'] }}" value="{{ settings['keep_warm']['temp'] }}" name="keep_warm_temp">
                                    </div>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ============================ PWM Settings ========================== -->
            {% if settings['globals']['dc_fan'] %}
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-pwm" role="tabpanel" aria-labelledby="v-pills-pwm-tab">
                <div class="card shadow">
                    <form name="pwm" action="/settings/pwm" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-tools"></i>&nbsp; PWM Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <!-- Temp Fan Control Settings -->
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-tachometer-alt"></i>&nbsp; PWM Temp Control Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="pwm_control" name="pwm_control" {% if settings['pwm']['pwm_control'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="pwm_control">Temp Control Enabled by Default</label>
                                    </div>
                                    <br>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small">If enabled PWM Temp Control will override Smoke Plus fan ramping. The fan will adjust with temperature and cycle on and off but will not ramp up to speed.</i>
                                    <br>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="How often the Fan Speed will be updated based on Temperature (seconds) [Default=10]">
                                                <i class="far fa-clock"></i>&nbsp; Update Time (s)
                                            </span>
                                        </div>
                                        <input id="pwm_update" type="number" min="1" class="form-control" placeholder="{{ settings['pwm']['update_time'] }}" value="{{ settings['pwm']['update_time'] }}" name="pwm_update">
                                    </div>
                                    <br>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small">If Current Grill Temp is over Set Temp Fan will be set to Minimum Duty Cycle. If the Grill temp is below the Set Temp the Duty Cycles below will be used. Example: If Current Grill Temp drops below Set Temp by 1-3 ° a 20% PWM will be set. If the Grill Temp drops below the Set Temp by 15° a 75% Duty Cycle will be set. </i>
                                    <br>
                                    <br>
                                    <table class="table table-sm" id="duty_cycle_table">
                                        <thead>
                                        <tr>
                                            <th scope="col">Action</th>
                                            <th scope="col">Temp Range</th>
                                            <th scope="col">Duty Cycle</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                        <tfoot>
                                        <tr>
                                            <td>
                                                <button type="button" class="btn btn-success btn-sm" data-toggle="modal" data-target="#dc_add_modal"><i class="fas fa-plus"></i></button>
                                            </td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        </tfoot>
                                    </table>
                                    <!-- Temp Fan Control Profile modal -->
                                    <div class="modal fade" id="dc_add_modal" tabindex="-1" aria-labelledby="dc_add_modal_label" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="dc_add_modal_label">Add PWM Temp Profile</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <span class="badge badge-warning">NOTE:</span>
                                                    <i class="small">Enter a value greater than <span id="dc_add_temp">0</span>{{ settings['globals']['units'] }}</i>
                                                    <br>
                                                    <br>
                                                    <div class="input-group mb-3">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text" id="dc_temp_label">Temp Range ({{ settings['globals']['units'] }})</span>
                                                        </div>
                                                        <input type="number" class="form-control" value="5" min="1" max="100" name="dc_temp" id="dc_temp" aria-label="Temp Range" aria-describedby="dc_temp_label">
                                                    </div>
                                                    <div class="input-group mb-3">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text" id="dc_duty_cycle_label">Duty Cycle (%)</span>
                                                        </div>
                                                        <input type="number" class="form-control" value="50" min="1" max="100" name="dc_duty_cycle" id="dc_duty_cycle" aria-label="Duty Cycle" aria-describedby="dc_duty_cycle_label">
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    <button type="button" class="btn btn-primary" data-dismiss="modal" onClick="onAddPWM()">Save changes</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div><!-- End of Add Modal-->
                                    <!-- Temp Fan Control Edit Profile modal -->
                                    <div class="modal fade" id="dc_edit_modal" tabindex="-1" aria-labelledby="dc_edit_modal_label" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="dc_edit_modal_label">Edit PWM Temp Profile</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <span class="badge badge-warning">NOTE:</span>
                                                    <i class="small" id="dc_edit_range_text">Enter a value in the range <span id="dc_edit_range_min">0</span>-<span id="dc_edit_range_max">100</span>{{ settings['globals']['units'] }}</i>
                                                    <br>
                                                    <br>
                                                    <div class="input-group mb-3">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text" id="dc_edit_temp_label">Temp Range ({{ settings['globals']['units'] }})</span>
                                                        </div>
                                                        <input type="number" class="form-control" value="55" min="0" max="200" name="dc_edit_temp" id="dc_edit_temp" aria-label="Temp Range" aria-describedby="dc_edit_temp_label">
                                                    </div>
                                                    <div class="input-group mb-3">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text" id="dc_edit_duty_cycle_label">Duty Cycle (%)</span>
                                                        </div>
                                                        <input type="number" class="form-control" value="50" min="1" max="100" name="dc_edit_duty_cycle" id="dc_edit_duty_cycle" aria-label="Duty Cycle" aria-describedby="dc_edit_duty_cycle_label">
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    <button type="button" class="btn btn-primary" id="dc_save_edits" value="" data-dismiss="modal" onClick="saveChangesPWM(this.value)">Save changes</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div><!-- End of Edit Modal-->
                                </div>
                            </div>
                            <br>
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-tools"></i>&nbsp; General Fan Settings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="PWM Fan Frequency. This will vary with different fans. [Default=100]">
                                                <i class="fas fa-wave-square"></i>&nbsp; Frequency (Hz)
                                            </span>
                                        </div>
                                        <input id="frequency" type="number" min="1" class="form-control" placeholder="{{ settings['pwm']['frequency'] }}" value="{{ settings['pwm']['frequency'] }}" name="frequency">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="This is the minimum duty cycle that can be set. Some fans stall below a certain speed [Default=20]">
                                                <i class="fas fa-tachometer-alt"></i>&nbsp; Min Duty Cycle
                                            </span>
                                        </div>
                                        <input id="min_duty_cycle" type="number" min="1" max="100" class="form-control" placeholder="{{ settings['pwm']['min_duty_cycle'] }}" value="{{ settings['pwm']['min_duty_cycle'] }}" name="min_duty_cycle">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="This is the maximum duty cycle that can be set. Can limit fans that are overpowered. If Fan is too overpowered settings a Duty Cycle > 50% is not advised. It would be best to source a fan with less CFM. [Default=100]">
                                                <i class="fas fa-tachometer-alt"></i>&nbsp; Max Duty Cycle
                                            </span>
                                        </div>
                                        <input id="max_duty_cycle" type="number" min="50" max="100" class="form-control" placeholder="{{ settings['pwm']['max_duty_cycle'] }}" value="{{ settings['pwm']['max_duty_cycle'] }}" name="max_duty_cycle">
                                    </div>
                                </div>
                            </div>
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div>
            {% endif %}
            <!-- End of Tab -->
            <!-- ============================ Startup/Shutdown Settings ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-timers" role="tabpanel" aria-labelledby="v-pills-timers-tab">
                <div class="card shadow">
                    <form name="startshutdowntimers" action="/settings/timers" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-tools"></i>&nbsp; Startup & Shutdown Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <!-- Startup Settings -->
							<div class="card shadow">
								<div class="card-header">
									<h5>
										<i class="fas fa-play"></i>&nbsp; Default Startup Settings
									</h5>
								</div>
								<div class="card-body">
									<span class="badge badge-warning">NOTE:</span>
									<i class="small"> Amount of time for startup before transitioning to next mode or attempting a reignite</i>
                                    <div class="input-group mb-3">
										<div class="input-group-prepend">
											<span class="input-group-text" data-toggle="tooltip" title="Startup timer (seconds) [Default=240]">
												<i class="far fa-clock"></i>&nbsp; Startup Timer (seconds)</span>
										</div>
										<input id="startup_timer" type="number" min="1" class="form-control" placeholder="{{ settings['globals']['startup_timer'] }}" value="{{ settings['globals']['startup_timer'] }}" name="startup_timer">
									</div>

									<span class="badge badge-warning">NOTE:</span>
									<i class="small"> Select what mode to transition to after initial startup. Default is 'Smoke Mode'.</i>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                          <label class="input-group-text" for="after_startup_mode">Goto Mode After Startup: </label>
                                        </div>
                                        <select class="custom-select" id="after_startup_mode" name="after_startup_mode">
                                          <option value="Smoke" {% if settings['start_to_mode']['after_startup_mode'] == 'Smoke' %}selected{% endif %}>Smoke Mode</option>
                                          <option value="Hold" {% if settings['start_to_mode']['after_startup_mode'] == 'Hold' %}selected{% endif %}>Hold Mode</option>
                                        </select>
                                    </div>

                                    <div id="startup_hold_value_input" class="input-group mb-3"{% if settings['start_to_mode']['after_startup_mode'] != 'Hold' %} style="display:none"{% endif %}>
										<div class="input-group-prepend">
											<span class="input-group-text" data-toggle="tooltip" title="Setpoint Temperature for Hold Mode">
                                                <i class="fas fa-temperature-low"></i>&nbsp; Hold Temp</span>
										</div>
										<input id="startup_timer" type="number" min="{{ settings['safety']['maxstartuptemp'] }}" max="{{ settings['safety']['maxtemp'] }}" class="form-control" value="{{ settings['start_to_mode']['primary_setpoint'] }}" name="startup_mode_setpoint">
                                    </div>

                                </div>
							</div>
							<br>
							<!-- Smart Start Settings -->
							<div class="card shadow">
								<div class="card-header">
									<h5>
										<i class="fas fa-brain"></i>&nbsp; Smart Start Settings
									</h5>
								</div>
								<div class="card-body">
									<span class="badge badge-warning">NOTE:</span>
									<i class="small"> Smart Start will sample the temperature from your grill temperature probe on startup to determine the startup mode time and the Smoke mode cycle settings.  If this mode is enabled, it will override the above startup and smoke cycle settings.  Edit the profiles below to customize the behavior of startup. </i>
                                    <br>
                                    <br>
									<div class="custom-control custom-switch">
										<input type="checkbox" class="custom-control-input" id="smartstart_enable" name="smartstart_enable" {% if settings['smartstart']['enabled'] %}checked{% endif %}>
										<label class="custom-control-label" for="smartstart_enable">Smart Start Enabled</label>
									</div>
                                    <br>
									<!-- Smart Start Profiles -->
									<table class="table table-sm" id="smartStartTable">
										<thead>
										  <tr>
											<th scope="col">Action</th>
											<th scope="col">Temp Range</th>
											<th scope="col">Startup</th>
											<th scope="col">AugerOn</th>
											<th scope="col">P-Mode</th>
										</tr>
										</thead>
										<tbody>
										</tbody>
										<tfoot>
											<tr>
												<td>
													<button type="button" class="btn btn-success btn-sm" data-toggle="modal" data-target="#sstrt_add_modal"><i class="fas fa-plus"></i></button>
												</td>
												<td></td>
												<td></td>
												<td></td>
												<td></td>
											</tr>
										</tfoot>
									</table>
									<!-- Smart Start ADD Profile modal -->
									<div class="modal fade" id="sstrt_add_modal" tabindex="-1" aria-labelledby="sstrt_add_modal_label" aria-hidden="true">
										<div class="modal-dialog">
										<div class="modal-content">
											<div class="modal-header">
											<h5 class="modal-title" id="sstrt_add_modal_label">Add Smart Start Profile</h5>
											<button type="button" class="close" data-dismiss="modal" aria-label="Close">
												<span aria-hidden="true">&times;</span>
											</button>
											</div>
											<div class="modal-body">
                                                <span class="badge badge-warning">NOTE:</span>
                                                <i class="small">Enter a value greater than <span id="addMinTemp">0</span>{{ settings['globals']['units'] }}</i>
												<div class="input-group mb-3">
													<div class="input-group-prepend">
													  <span class="input-group-text" id="minTempLabel">Min Temperature({{ settings['globals']['units'] }})</span>
													</div>
													<input type="number" class="form-control" value="55" min="0" max="200" name="minTemp" id="minTemp" aria-label="Min Temperature" aria-describedby="minTempLabel">
												</div>
												<div class="input-group mb-3">
													<div class="input-group-prepend">
													  <span class="input-group-text" id="startupTimeLabel">Startup Time(s)</span>
													</div>
													<input type="number" class="form-control" value="240" min="30" max="1200" name="startupTime" id="startupTime" aria-label="Startup Time" aria-describedby="startupTimeLabel">
												</div>
												<div class="input-group mb-3">
													<div class="input-group-prepend">
													  <span class="input-group-text" id="augeronTimeLabel">Auger On Time(s)</span>
													</div>
													<input type="number" class="form-control" value="15" min="1" max="1000" name="augeronTime" id="augeronTime" aria-label="Auger On Time" aria-describedby="augeronTimeLabel">
												</div>
												<div class="input-group mb-3">
													<div class="input-group-prepend">
													  <span class="input-group-text" id="pModeLabel">P-Mode</span>
													</div>
													<input type="number" class="form-control" value="2" min="0" max="9" name="pMode" id="pMode" aria-label="P-Mode" aria-describedby="pModeLabel">
												</div>

											</div>
											<div class="modal-footer">
											<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
											<button type="button" class="btn btn-primary" data-dismiss="modal" onClick="onAdd()">Save changes</button>
											</div>
										</div>
										</div>
									</div><!-- End of Add Modal-->
                                    <!-- Smart Start EDIT Profile modal -->
									<div class="modal fade" id="sstrt_edit_modal" tabindex="-1" aria-labelledby="sstrt_edit_modal_label" aria-hidden="true">
										<div class="modal-dialog">
										<div class="modal-content">
											<div class="modal-header">
											<h5 class="modal-title" id="sstrt_edit_modal_label">Edit Smart Start Profile</h5>
											<button type="button" class="close" data-dismiss="modal" aria-label="Close">
												<span aria-hidden="true">&times;</span>
											</button>
											</div>
											<div class="modal-body">
                                                <span class="badge badge-warning">NOTE:</span>
                                                <i class="small" id="edit_RangeText">Enter a value in the range <span id="editRangeMin">0</span>-<span id="editRangeMax">200</span>{{ settings['globals']['units'] }}</i>
                                                <div class="input-group mb-3">
													<div class="input-group-prepend">
													  <span class="input-group-text" id="edit_minTempLabel">Max Temperature({{ settings['globals']['units'] }})</span>
													</div>
													<input type="number" class="form-control" value="55" min="0" max="200" name="edit_minTemp" id="edit_minTemp" aria-label="Min Temperature" aria-describedby="edit_minTempLabel">
												</div>
												<div class="input-group mb-3">
													<div class="input-group-prepend">
													  <span class="input-group-text" id="edit_startupTimeLabel">Startup Time(s)</span>
													</div>
													<input type="number" class="form-control" value="240" min="30" max="1200" name="edit_startupTime" id="edit_startupTime" aria-label="Startup Time" aria-describedby="edit_startupTimeLabel">
												</div>
												<div class="input-group mb-3">
													<div class="input-group-prepend">
													  <span class="input-group-text" id="edit_augeronTimeLabel">Auger On Time(s)</span>
													</div>
													<input type="number" class="form-control" value="15" min="1" max="1000" name="edit_augeronTime" id="edit_augeronTime" aria-label="Auger On Time" aria-describedby="edit_augeronTimeLabel">
												</div>
												<div class="input-group mb-3">
													<div class="input-group-prepend">
													  <span class="input-group-text" id="edit_pModeLabel">P-Mode</span>
													</div>
													<input type="number" class="form-control" value="2" min="0" max="9" name="edit_pMode" id="edit_pMode" aria-label="P-Mode" aria-describedby="edit_pModeLabel">
												</div>
											</div>
											<div class="modal-footer">
											<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
											<button type="button" class="btn btn-primary" id="saveEdits" value="" data-dismiss="modal" onClick="saveChanges(this.value)">Save changes</button>
											</div>
										</div>
										</div>
									</div><!-- End of Add Modal-->
								</div><!-- End of Smart Start Settings Card Body -->
							</div><!-- End of Smart Start Settings Card-->
							<br>
							<!-- Shutdown Settings -->
							<div class="card shadow">
								<div class="card-header">
									<h5>
										<i class="fas fa-flag-checkered"></i>&nbsp; Default Shutdown Settings
									</h5>
								</div>
								<div class="card-body">
									<div class="input-group mb-3">
										<div class="input-group-prepend">
											<span class="input-group-text" data-toggle="tooltip" title="Shutdown timer (seconds) [Default=60]">
												<i class="far fa-clock"></i>&nbsp; Shutdown Timer (seconds)</span>
										</div>
										<input id="shutdown_timer" type="number" min="1" class="form-control" placeholder="{{ settings['globals']['shutdown_timer'] }}" value="{{ settings['globals']['shutdown_timer'] }}" name="shutdown_timer">
									</div>
									<span class="badge badge-warning">NOTE:</span>
									<i class="small"> Amount of time fan will run after shutdown is selected </i>
									<br>
									<br>
									<div class="custom-control custom-switch">
										<input type="checkbox" class="custom-control-input" id="auto_power_off" name="auto_power_off" {% if settings['globals']['auto_power_off'] %}checked{% endif %}>
										<label class="custom-control-label" for="auto_power_off">Auto Power Off</label>
									</div>
                                    <br>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> When enabled the Raspberry Pi will auto power off after the Grill Shutdown Mode has ended</i>
                                    <br>
								</div>
							</div> <!-- End of Shutdown Settings Card-->
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            
            <!-- ============================ Dashboard Settings ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-dash" role="tabpanel" aria-labelledby="v-pills-dash-tab">
                <div class="card shadow">
                    <form name="miscsettings" action="/settings/dashboard" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-tools"></i>&nbsp; Dashboard Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label for="dashboardSelect">Select Dashboard</label>
                                <select class="form-control" id="dashboardSelect" name="dashboardSelect">
                                    {% for dashboard in settings['dashboard']['dashboards'] %}
                                    <option value="{{ dashboard['name'] }}"{% if dashboard['name'] == settings['dashboard']['current'] %} selected{% endif %}>{{ dashboard['name'] }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->


            <!-- ============================ History Settings ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-history" role="tabpanel" aria-labelledby="v-pills-history-tab">
                <div class="card shadow">
                    <form name="miscsettings" action="/settings/history" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-tools"></i>&nbsp; History Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" data-toggle="tooltip" title="Amount of history to display on the history page (minutes). [Default = 60]">
                                        <i class="far fa-clock"></i>&nbsp; History to Display (mins)</span>
                                </div>
                                <input id="historymins" type="number" min="1" class="form-control" placeholder="{{ settings['history_page']['minutes'] }}" value="{{ settings['history_page']['minutes'] }}" name="historymins">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" data-toggle="tooltip" title="Number of datapoints to display per page.">
                                        <i class="far fa-clock"></i>&nbsp; Datapoints to Display</span>
                                </div>
                                <input id="datapoints" type="number" min="10" class="form-control" placeholder="{{ settings['history_page']['datapoints'] }}" value="{{ settings['history_page']['datapoints'] }}" name="datapoints">
                            </div>

                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input" id="historyautorefresh" name="historyautorefresh" {% if settings['history_page']['autorefresh'] == 'on' %}checked{% endif %}>
                                <label class="custom-control-label" for="historyautorefresh">History Auto-Refresh</label>
                            </div>
                            <br>
                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input" id="ext_data" name="ext_data" {% if settings['globals']['ext_data'] %}checked{% endif %}>
                                <label class="custom-control-label" for="ext_data">Track Extended Data<br>
                                    <span class="badge badge-warning">DEBUG</span> 
                                    <i>Extended data is stored in the database, and exported to cookfile/CSV files for debug purposes.  This setting can only be changed when the grill is inactive (i.e. 'Stop' mode). </i>
                                </label>
                            </div>
                            <br>

                            <div class="card shadow">
                                <div class="card-header">
                                    <span class="align-middle">
                                        <button type="button" class="btn btn-outline-primary" data-toggle="collapse" data-target="#collapseColors" aria-expanded="false" aria-controls="collapseColors">
                                            <i class="fas fa-palette"></i>&nbsp; Expand Color Config
                                        </button>
                                    </span>
                                </div>
                                <div class="collapse" id="collapseColors">
                                <div class="card-body">
                                    <span class="badge badge-primary">Note</span> 
                                    <i>Click on the color swatch on the right of each line item to use the integrated color picker.  
                                        Configure the line color and background color for each Probe, Probe Notification Target, and for Primary Probes, the Setpoint.</i>
                                    <br><br>
                                    {% for probe in settings['history_page']['probe_config'] %}
                                    <div id="clrpck_temp_{{ probe }}" class="input-group" data-color="{{ settings['history_page']['probe_config'][probe]['line_color'] }}">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">{{ settings['history_page']['probe_config'][probe]['name'] }} Temperature Color</span>
                                        </div>
                                        <input type="text" class="form-control input-lg" id="clr_temp_{{ probe }}" name="clr_temp_{{ probe }}"/>
                                        <span class="input-group-append">
                                            <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                        </span>
                                    </div>
                                    <div id="clrpck_bgtemp_{{ probe }}" class="input-group" data-color="{{ settings['history_page']['probe_config'][probe]['bg_color'] }}">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">{{ settings['history_page']['probe_config'][probe]['name'] }} Background Temperature Color</span>
                                        </div>
                                        <input type="text" class="form-control input-lg" id="clrbg_temp_{{ probe }}" name="clrbg_temp_{{ probe }}"/>
                                        <span class="input-group-append">
                                            <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                        </span>
                                    </div>
                                    {% if 'line_color_setpoint' in settings['history_page']['probe_config'][probe].keys() %} 
                                    <div id="clrpck_setpoint_{{ probe }}" class="input-group" data-color="{{ settings['history_page']['probe_config'][probe]['line_color_setpoint'] }}">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">{{ settings['history_page']['probe_config'][probe]['name'] }} Setpoint Color</span>
                                        </div>
                                        <input type="text" class="form-control input-lg" id="clr_setpoint_{{ probe }}" name="clr_setpoint_{{ probe }}"/>
                                        <span class="input-group-append">
                                            <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                        </span>
                                    </div>
                                    <div id="clrpck_bgsetpoint_{{ probe }}" class="input-group" data-color="{{ settings['history_page']['probe_config'][probe]['bg_color_setpoint'] }}">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">{{ settings['history_page']['probe_config'][probe]['name'] }} Background Setpoint Color</span>
                                        </div>
                                        <input type="text" class="form-control input-lg" id="clrbg_setpoint_{{ probe }}" name="clrbg_setpoint_{{ probe }}"/>
                                        <span class="input-group-append">
                                            <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                        </span>
                                    </div>
                                    {% endif %}
                                    <div id="clrpck_target_{{ probe }}" class="input-group" data-color="{{ settings['history_page']['probe_config'][probe]['line_color_target'] }}">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">{{ settings['history_page']['probe_config'][probe]['name'] }} Notify Target Color</span>
                                        </div>
                                        <input type="text" class="form-control input-lg" id="clr_target_{{ probe }}" name="clr_target_{{ probe }}"/>
                                        <span class="input-group-append">
                                            <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                        </span>
                                    </div>
                                    <div id="clrpck_bgtarget_{{ probe }}" class="input-group" data-color="{{ settings['history_page']['probe_config'][probe]['bg_color_target'] }}">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">{{ settings['history_page']['probe_config'][probe]['name'] }} Background Notify Target Color</span>
                                        </div>
                                        <input type="text" class="form-control input-lg" id="clrbg_target_{{ probe }}" name="clrbg_target_{{ probe }}"/>
                                        <span class="input-group-append">
                                            <span class="input-group-text colorpicker-input-addon"><i></i></span>
                                        </span>
                                    </div>
                                    <br>
                                    {% endfor %}
                                </div> <!-- End of card body -->
                            </div> <!-- End of collapse -->
                        </div> <!-- End of Color Picker Card -->
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ============================ Safety Settings ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-safety" role="tabpanel" aria-labelledby="v-pills-safety-tab">
                <div class="card shadow">
                    <form name="safetysettings" action="/settings/safety" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-tools"></i>&nbsp; Safety Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" data-toggle="tooltip" title="Lowest temperature after startup allowed.  Shut down grill to prevent firepot overload.">
                                        <i class="fas fa-temperature-high"></i>&nbsp; Min Startup Temp ({{settings['globals']['units']}})
                                    </span>
                                </div>
                                <input id="minstartuptemp" type="number" min="1" class="form-control" placeholder="{{ settings['safety']['minstartuptemp'] }}" value="{{ settings['safety']['minstartuptemp'] }}" name="minstartuptemp">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" data-toggle="tooltip" title="Lowest allowed operational temperature, after startup has completed. Shut down grill to prevent firepot overload.">
                                        <i class="fas fa-temperature-high"></i>&nbsp; Max Startup Temp ({{settings['globals']['units']}})</span>
                                </div>
                                <input id="maxstartuptemp" type="number" min="1" class="form-control" placeholder="{{ settings['safety']['maxstartuptemp'] }}" value="{{ settings['safety']['maxstartuptemp'] }}" name="maxstartuptemp">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" data-toggle="tooltip" title="Number of retries to attempt re-ignite after the grill temperature goes too low. Set to zero to disable. [default=1]">
                                        <i class="fas fa-redo-alt"></i>&nbsp; Reignite Retries</span>
                                </div>
                                <input id="reigniteretries" type="number" min="0" max="10" class="form-control" placeholder="{{ settings['safety']['reigniteretries'] }}" value="{{ settings['safety']['reigniteretries'] }}" name="reigniteretries">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" data-toggle="tooltip" title="Maximum allowable temperature.  Shut down grill to prevent potential damage.">
                                        <i class="fas fa-temperature-high"></i>&nbsp; Max Operational Temp ({{settings['globals']['units']}})</span>
                                </div>
                                <input id="maxtemp" type="number" min="1" class="form-control" placeholder="{{ settings['safety']['maxtemp'] }}" value="{{ settings['safety']['maxtemp'] }}" name="maxtemp">
                            </div>
                            <span class="badge badge-warning">NOTE:</span>
                            <i class="small"> In an error condition (temp too low, temp too high) the grill will immediately shutdown and log the error in the events log. Notifications of an error will be sent if enabled. The Max Temp safety setting is also enabled in Monitor mode.</i>
                            <br>
                            <br>
                            <span class="badge badge-danger">WARNING:</span>
                            <i class="small"> Safety features are not infallible and may not prevent safety issues with your grill in all cases. As with any grill, it is the operator's responsibility to monitor their equipment to ensure proper operational safety.</i>
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ============================ Pellet Settings ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-pellets" role="tabpanel" aria-labelledby="v-pills-pellets-tab">
                <div class="card shadow">
                    <form name="pelletsettings" action="/settings/pellets" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-tools"></i>&nbsp; Pellet Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-tools"></i>&nbsp; Pellet Warnings
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="pellet_warning" name="pellet_warning" {% if settings['pelletlevel']['warning_enabled'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="pellet_warning">Pellet Level Warning</label>
                                    </div>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="How often the pellet level will be checked for low levels and notifications sent. (minutes)">
                                                <i class="far fa-clock"></i>&nbsp; Check Time (mins)
                                            </span>
                                        </div>
                                        <input id="warning_time" type="number" min="5" max="240" class="form-control" placeholder="{{ settings['pelletlevel']['warning_time'] }}" value="{{ settings['pelletlevel']['warning_time'] }}" name="warning_time">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Low Pellet Level Warning (percent)">
                                                <i class="fas fa-exclamation-triangle"></i>&nbsp; Level Warning (%)
                                            </span>
                                        </div>
                                        <input id="warning_level" type="number" min="0" max="100" class="form-control" placeholder="{{ settings['pelletlevel']['warning_level'] }}" value="{{ settings['pelletlevel']['warning_level'] }}" name="warning_level">
                                    </div>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> Pellet levels below the input percent will receive notifications every {{ settings['pelletlevel']['warning_time'] }} minutes during a cook</i>
                                    <br>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-tools"></i>&nbsp; Pellet Levels
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Distance (cm) measured when the hopper is full.">
                                                <i class="fas fa-level-up-alt"></i>&nbsp; Hopper Full Distance (cm)
                                            </span>
                                        </div>
                                        <input id="full" type="number" min="0" max="100" class="form-control" placeholder="{{ settings['pelletlevel']['full'] }}" value="{{ settings['pelletlevel']['full'] }}" name="full">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Distance (cm) measured when the hopper is empty.">
                                                <i class="fas fa-level-down-alt"></i>&nbsp; Hopper Empty Distance (cm)
                                            </span>
                                        </div>
                                        <input id="empty" type="number" min="1" max="100" class="form-control" placeholder="{{ settings['pelletlevel']['empty'] }}" value="{{ settings['pelletlevel']['empty'] }}" name="empty">
                                    </div>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> The distance value for full must be smaller than the value for empty. </i>
                                    <br>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <div class="card shadow">
                                <div class="card-header">
                                    <h5>
                                        <i class="fas fa-tools"></i>&nbsp; Auger Rate
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" data-toggle="tooltip" title="Auger Rate = grams / second">
                                                <i class="fas fa-angle-double-right"></i>&nbsp; Auger Rate (g/s)
                                            </span>
                                        </div>
                                        <input id="auger_rate" type="number" min="0" step="0.05" class="form-control" value="{{ settings['globals']['augerrate'] }}" name="auger_rate">
                                    </div>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> This value is used to calculate how long to run the auger when priming, and to calculate estimated pellet usage.
                                    This value can be tuned for your auger speed, by going into manual mode and running the auger for 10 seconds, then weighing the pellets
                                    that have been dispensed into the firepot.  For example, if you run the auger for 10 seconds and 3 grams of pellets are dispensed, then
                                    the calculation would be 3g / 10s = 0.3.  That means 0.3 grams are dispensed per second of auger on time.     
                                    </i>
                                    <br>
                                </div>
                            </div>
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ============================ Page Settings ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-theme" role="tabpanel" aria-labelledby="v-pills-theme-tab">
                <div class="card shadow">
                    <form name="pagesettings" action="/settings/pagesettings" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="fas fa-tools"></i>&nbsp; Page Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input" id="darkmode" name="darkmode" {% if settings['globals']['page_theme'] == 'dark' %}checked{% endif %}>
                                <label class="custom-control-label" for="darkmode">Enable Dark Mode</label>
                            </div>
                            <br>
                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input" id="global_control_panel" name="global_control_panel" {% if settings['globals']['global_control_panel'] %}checked{% endif %}>
                                <label class="custom-control-label" for="global_control_panel">Show Control Panel on Most Pages</label>
                            </div>
                            <br>
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
            <!-- ========================== Notification Settings ========================== -->
            {% if request.MOBILE %}<br>{% endif %}
            <div class="tab-pane fade {% if request.MOBILE %} show active {% endif %}" id="v-pills-notifications" role="tabpanel" aria-labelledby="v-pills-notifications-tab">
                <div class="card shadow">
                    <form name="notify" action="/settings/notify" method="POST">
                        <div class="card-header bg-primary text-white">
                            <h5>
                                <i class="far fa-bell"></i>&nbsp; Notification Settings
                            </h5>
                        </div>
                        <div class="card-body">
                            <!-- Apprise Notifications -->
                            <div class="card shadow-sm">
                                <div class="card-header">
                                    <h5>Apprise Notifications</h5>
                                </div>
                                <div class="card-body">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="apprise_enabled" name="apprise_enabled" {% if settings['notify_services']['apprise']['enabled'] == True %}checked{% endif %}>
                                        <label class="custom-control-label" for="apprise_enabled">Apprise Enabled</label>
                                    </div>
                                    <br>
                                    {% if settings['notify_services']['apprise']['locations']|length %}
                                    {% for location in settings['notify_services']['apprise']['locations'] %}<div class="input-group mb-3 appriselocation">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="fas fa-link"></i>&nbsp; Location</span>
                                        </div>
                                        <input id="appriselocations" type="text" class="form-control" name="appriselocations" value="{{location}}" placeholder="format://user@location/authorization">
                                        <div class="input-group-append">
                                            <button type="button" name="appriseDeleteRow" class="btn btn-danger"><i class="fas fa-minus"></i></button>
                                        </div>
                                    </div>{% endfor %}
                                    {% else %}<div class="input-group mb-3 appriselocation">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="fas fa-link"></i>&nbsp; Location</span>
                                        </div>
                                        <input id="appriselocations" type="text" class="form-control" name="appriselocations" value="" placeholder="format://user@location/authorization">
                                        <div class="input-group-append">
                                            <button type="button" name="appriseDeleteRow" class="btn btn-danger"><i class="fas fa-minus"></i></button>
                                        </div>
                                    </div>{% endif %}
                                    <div class="mb-3 text-right">
                                        <button type="button" name="addAppriseLocation" class="btn btn-primary"><i class="fas fa-plus"></i> Add Location</button>
                                    </div>
                                </div>
                                <!-- End of card body -->
                            </div>
                            <!-- End of Card -->
                            <br>
                            <!-- IFTTT WebHooks -->
                            <div class="card shadow-sm">
                                <div class="card-header">
                                    <h5>IFTTT WebHooks</h5>
                                </div>
                                <div class="card-body">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="ifttt_enabled" name="ifttt_enabled" {% if settings['notify_services']['ifttt']['enabled'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="ifttt_enabled">IFTTT Enabled</label>
                                    </div>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="fas fa-key"></i>&nbsp; API Key</span>
                                        </div>
                                        <input id="iftttapi" type="text" class="form-control" name="iftttapi" value="{{settings['notify_services']['ifttt']['APIKey']}}">
                                    </div>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <!-- PushOver Notifications -->
                            <div class="card shadow-sm">
                                <div class="card-header">
                                    <h5>PushOver</h5>
                                </div>
                                <div class="card-body">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="pushover_enabled" name="pushover_enabled" {% if settings['notify_services']['pushover']['enabled'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="pushover_enabled">PushOver Enabled</label>
                                    </div>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="fas fa-key"></i>&nbsp; API Key</span>
                                        </div>
                                        <input id="pushover_apikey" type="text" class="form-control" name="pushover_apikey" value="{{settings['notify_services']['pushover']['APIKey']}}">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="fas fa-key"></i>&nbsp; User Keys</span>
                                        </div>
                                        <input id="pushover_userkeys" type="text" class="form-control" name="pushover_userkeys" value="{{settings['notify_services']['pushover']['UserKeys']}}">
                                    </div>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> Add commas for multiple user keys. Leave blank to disable.</i>
                                    <br>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="fas fa-link"></i>&nbsp; Public URL </span>
                                        </div>
                                        <input id="pushover_publicurl" type="text" class="form-control" name="pushover_publicurl" value="{{settings['notify_services']['pushover']['PublicURL']}}">
                                    </div>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> URL to be added to Pushover notifications.</i>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <!-- Pushbullet Notifications -->
                            <div class="card shadow-sm">
                                <div class="card-header">
                                    <h5>Pushbullet</h5>
                                </div>
                                <div class="card-body">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="pushbullet_enabled" name="pushbullet_enabled" {% if settings['notify_services']['pushbullet']['enabled'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="pushbullet_enabled">Pushbullet Enabled</label>
                                    </div>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="fas fa-key"></i>&nbsp; API Key</span>
                                        </div>
                                        <input id="pushbullet_apikey" type="text" class="form-control" name="pushbullet_apikey" value="{{settings['notify_services']['pushbullet']['APIKey']}}">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">
                                                <i class="fas fa-link"></i>&nbsp; Public URL</span>
                                        </div>
                                        <input id="pushbullet_publicurl" type="text" class="form-control" name="pushbullet_publicurl" value="{{settings['notify_services']['pushbullet']['PublicURL']}}">
                                    </div>
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> URL to be added to Pushbullet notifications.</i>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <!-- Android Push Notifications -->
                            <div class="card shadow-sm">
                                <div class="card-header">
                                    <h5>Push Notifications</h5>
                                </div>
                                <div class="card-body">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input"
                                               id="onesignal_enabled"
                                               name="onesignal_enabled" {% if settings['notify_services']['onesignal']['enabled'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="onesignal_enabled">OneSignal Enabled</label>
                                    </div>
                                    <br>
                                    {% for index, data in settings['notify_services']['onesignal']['devices'].items()|sort %}
                                    <div class="card shadow">
                                        <div class="card-header bg-light text-white">
                                            <h5>
                                                <a href="#edit_device{{ index }}" data-toggle="collapse">
                                                    {% if data['friendly_name'] == '' %}
                                                    <i class="far fa-caret-square-down"></i>&nbsp; {{ data['device_name'] }}
                                                    {% else %}
                                                    <i class="far fa-caret-square-down"></i>&nbsp; {{ data['friendly_name'] }}
                                                    {% endif %}
                                                </a>
                                            </h5>
                                        </div>
                                        <div id="edit_device{{ index }}" class="collapse">
                                            <div class="card-body">
                                                <div class="input-group mb-3">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text" data-toggle="tooltip" title="Human readable name for device used to display above.">
                                                            <i class="fas fa-user-circle"></i>&nbsp; Friendly Name
                                                        </span>
                                                    </div>
                                                    <input id="FriendlyName_{{ index }}" type="text" class="form-control" name="FriendlyName_{{ index }}" value="{{ data['friendly_name'] }}">
                                                </div>
                                                <div class="input-group mb-3">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text" data-toggle="tooltip" title="The factory device name">
                                                            <i class="fas fa-user-circle"></i>&nbsp; Device Name</span>
                                                    </div>
                                                    <input id="DeviceName_{{ index }}" type="text" class="form-control" name="DeviceName_{{ index }}" value="{{ data['device_name'] }}" readonly>
                                                </div>
                                                <div class="input-group mb-3">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text" data-toggle="tooltip" title="Android app version">
                                                            <i class="fas fa-info-circle"></i>&nbsp; App Version</span>
                                                    </div>
                                                    <input id="AppVersion_{{ index }}" type="text" class="form-control" name="AppVersion_{{ index }}" value="{{ data['app_version'] }}" readonly>
                                                </div>
                                                <div class="input-group mb-3">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text" data-toggle="tooltip" title="The OneSignal device ID">
                                                            <i class="fas fa-fingerprint"></i>&nbsp; OneSignal Device ID</span>
                                                    </div>
                                                    <input id="DeviceID_{{ index }}" type="text" class="form-control" name="DeviceID_{{ index }}" value="{{ index }}" disabled>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-light">
                                                <button type="submit" class="btn btn-primary" name="edit_device" value="{{ index }}">Save</button>
                                                <!-- Button to Open the Modal -->
                                                <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#DeleteDeviceModal{{ index }}">Delete</button>
                                                <!-- The Modal -->
                                                <div class="modal" id="DeleteDeviceModal{{ index }}">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            <!-- Modal Header -->
                                                            <div class="modal-header">
                                                                {% if data['friendly_name'] == '' %}
                                                                <h4 class="modal-title">Delete Device {{ data['device_name'] }}</h4>
                                                                {% else %}
                                                                <h4 class="modal-title">Delete Device {{ data['friendly_name'] }}</h4>
                                                                {% endif %}
                                                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                            </div>
                                                            <!-- Modal body -->
                                                            {% if data['friendly_name'] == '' %}
                                                            <div class="modal-body"> Are you sure you want to delete the {{ data['device_name'] }} device?</div>
                                                            {% else %}
                                                            <div class="modal-body"> Are you sure you want to delete the {{ data['friendly_name'] }} device?</div>
                                                            {% endif %}
                                                            <!-- Modal footer -->
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                                <button type="submit" class="btn btn-danger" name="delete_device" value="{{ index }}">Delete</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                    {% endfor %}
                                    <span class="badge badge-warning">NOTE:</span>
                                    <i class="small"> You can download the Android application from <a href="https://github.com/weberbox/PiFire-Android" target="blank">Github</a> </i>
                                    <br>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                            <br>
                            <!-- InfluxDB Notifications -->
                            <div class="card shadow-sm">
                                <div class="card-header">
                                    <h5>InfluxDB</h5>
                                </div>
                                <div class="card-body">
                                    <div class="custom-control custom-switch">
                                        <input type="checkbox" class="custom-control-input" id="influxdb_enabled" name="influxdb_enabled" {% if settings['notify_services']['influxdb']['enabled'] %}checked{% endif %}>
                                        <label class="custom-control-label" for="influxdb_enabled">InfluxDB Enabled</label>
                                    </div>
                                    <br>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="fas fa-key"></i>&nbsp; URL </span>
                                        </div>
                                        <input id="influxdb_url" type="text" class="form-control" name="influxdb_url" value="{{settings['notify_services']['influxdb']['url']}}">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="fas fa-key"></i>&nbsp; token </span>
                                        </div>
                                        <input id="influxdb_token" type="text" class="form-control" name="influxdb_token" value="{{settings['notify_services']['influxdb']['token']}}">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="fas fa-key"></i>&nbsp; org </span>
                                        </div>
                                        <input id="influxdb_org" type="text" class="form-control" name="influxdb_org" value="{{settings['notify_services']['influxdb']['org']}}">
                                    </div>
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <i class="fas fa-key"></i>&nbsp; bucket </span>
                                        </div>
                                        <input id="influxdb_bucket" type="text" class="form-control" name="influxdb_bucket" value="{{settings['notify_services']['influxdb']['bucket']}}">
                                    </div>
                                </div><!-- End of card body -->
                            </div><!-- End of Card -->
                        </div><!-- End of card body -->
                        <div class="card-footer bg-light">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div><!-- End of Card -->
                {% if not request.MOBILE %}<br><br><br>{% endif %}
            </div><!-- End of Tab -->
        </div>
    </div>
</div>
{% endblock %}
{% block postcontainer %}
{% endblock %}
{% block scripts %}
<script>
    var dc_fan_enabled = "{{ settings['globals']['dc_fan'] }}";
</script>
<script src="{{ url_for('static', filename='js/bootstrap-colorpicker.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/settings.js') }}"></script>

{% endblock %}