{% macro render_probe_devices(probe_map, modules, alerts) %} 
<div id="probeDevicesCard">
    {% if alerts != [] %}
    <!-- Alerts -->
    <div id="alerts">
    {% for alert in alerts %}
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
            <strong><i class="fas fa-exclamation-circle"></i>&nbsp; Oops! Something isn't right.</strong><br>
            <i>{{ alert['message'] }}</i>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
        </div>
    {% endfor %}
    </div>
    {% endif %}

    <!-- Device List -->
    <div class="card shadow"> 
        <div class="card-header">
            Probe Input Devices
        </div>
        <div class="card-body">
            <table class="table">
                <thead class="thead-light">
                    <tr>
                    <th scope="col">Thumbnail</th>
                    <th scope="col">Name</th>
                    <th scope="col">Type</th>
                    <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for device in probe_map['probe_devices'] %}
                    <tr>
                        <td class="align-middle">
                            <img src="{{ url_for('static', filename='img/wizard/' + modules[device['module']]['image']) }}" class="rounded" alt="thumbnail" width="48" height="48"> 
                        </td>
                        <td class="align-middle">{{ device['device'] }}</td>
                        <td class="align-middle">{{ device['module'] }}</td>
                        <td class="align-middle" style="width: 20%">
                            <div class="btn-toolbar" role="toolbar">
                                <div class="btn-group mr-2">
                                    <button class="btn btn-primary btn-sm text-white" type="button" data-val="{{ device['device'] }}" data-toggle="modal" data-target="#editProbeDeviceModal" onclick="probe_editShowDeviceConfig('{{ device['device'] }}')"><i class="far fa-edit"></i></button>
                                </div>
                                <div class="btn-group mr-2">
                                    <button class="btn btn-danger btn-sm text-white" type="button" data-val="{{ device['device'] }}" data-toggle="modal" data-target="#delProbeDeviceModal" onclick="probe_selectDevice('{{ device['device'] }}')"><i class="far fa-trash-alt"></i></button>
                                </div>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                    <tr>
                        <td class="align-top"></td>
                        <td class="align-top"></td>
                        <td class="align-top"></td>
                        <td class="align-top">
                            <button class="btn btn-success btn-sm text-white" type="button" id="addProbeDevice" data-toggle="modal" data-target="#addProbeDeviceModal"><i class="fas fa-plus"></i></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <input type="hidden" id="probeModuleList" name="probeModuleList" value="{% for device in probe_map['probe_devices'] %}{{device['module']}}<br>{% endfor %}">

    <!-- Device List Modals -->
    <!-- delProbeDeviceModal -->
    <div class="modal fade" id="delProbeDeviceModal" tabindex="-1" aria-labelledby="delProbeDeviceModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="delProbeDeviceModalLabel">Delete Probe Device?</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
            Are you sure you want to delete this probe device?<br>
            <i><strong>Note:</strong>&nbsp; All probes associated with this device will also be deleted.</i>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-danger" data-dismiss="modal" value="" id="probeDelDeviceBtn" onclick="probe_deleteDevice('delProbeDeviceModal')">Confirm</button>
            </div>
        </div>
        </div>
    </div>

    <!-- editProbeDeviceModal -->
    <div class="modal fade" id="editProbeDeviceModal" tabindex="-1" aria-labelledby="editProbeDeviceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="editProbeDeviceModalLabel">Edit Probe Device</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body" id="editProbeDeviceField">
            Configure the probe device here! 
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" data-dismiss="modal" val="" id="probeEditDeviceBtn" onclick="probe_editSubmitDeviceConfig()">Save</button>
            </div>
        </div>
        </div>
    </div>

    <!-- addProbeDeviceModal -->
    <div class="modal fade" id="addProbeDeviceModal" tabindex="-1" aria-labelledby="addProbeDeviceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="addProbeDeviceModalLabel">Add Probe Device</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
                <!-- Select Drop Down -->
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" for="addProbeDeviceSelect">Select Device</label>
                    </div>
                    <select class="form-control" id="addProbeDeviceSelect" name="addProbeDeviceSelect" onchange="probe_addShowDeviceConfig(this.value)">
                        <option value="none" selected disabled hidden>Select a Device Module</option>
                        {% for module, object in modules.items()|sort %}
                        <option value="{{ module }}">
                        {{ object['friendly_name'] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div id="addProbeDeviceField">
                    <!-- Probe Device Configuration Info Here -->
                </div>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" data-dismiss="modal" val="" id="probeAddDeviceBtn" onclick="probe_addSubmitDeviceConfig()">Save</button>
            </div>
        </div>
        </div>
    </div>
</div>
{% endmacro %}

{% macro render_probe_device_settings(moduleData, moduleSection, defaultName, defaultConfig, available_probes, mode) %} 
<!-- Form for Selected Module -->
<div class="card">
	<div class="media">
		<img src="{{ url_for('static', filename='img/wizard/' + moduleData['image']) }}">
		<div class="media-body">
			<h5 class="mt-0">{{ moduleData['friendly_name'] }}</h5>
			<br>
			{{ moduleData['description'] }}
			<br>
			{% if moduleData['notes'] %}
			<br>
			<span class="badge badge-warning">NOTE:</span>
			<i class="small"> {{ moduleData['notes'] }} </i>
			<br>
			<br>
			{% endif %}
		</div>
	</div>

	<table class="table">
		<thead class="thead-light">
			<tr>
			<th scope="col">Setting</th>
			<th scope="col">Options</th>
			<th scope="col">Description</th>
			</tr>
		</thead>
		<tbody>
            <!-- Device Specifc Configuration Items-->
            {% for setting in moduleData['device_specific']['config'] %}
			<tr>
				<td>
                    {{ moduleData['device_specific']['config'][setting]['friendly_name'] }}
                </td>
				<td>
                    {% if setting == 'probes_list' %} 
                    <select multiple class="form-control deviceSpecific{{ mode }}" id="{{ moduleSection }}_devspec_{{ setting }}" name="{{ moduleSection }}_devspec_{{ setting }}">
                        {% for probe in available_probes %}
                        <option value="{{ probe }}" {% if probe in defaultConfig['probes_list'] %}selected{% endif %}>{{ probe }}</option>
                        {% endfor %}
                    </select>
                    {% else %}
                    <select class="form-control deviceSpecific{{ mode }}" id="{{ moduleSection }}_devspec_{{ setting }}" name="{{ moduleSection }}_devspec_{{ setting }}">
					{% for option in moduleData['device_specific']['config'][setting]['options'] %}
                        <option value="{{ option }}" {% if option == defaultConfig[setting] %}selected{% endif %}>{{ moduleData['device_specific']['config'][setting]['options'][option] }}</option>
                    {% endfor %}
					</select>
                    {% endif %}
                </td>
				<td>
                    {{ moduleData['device_specific']['config'][setting]['description'] }}
                </td>
				</tr>
			{% endfor %}
            <tr>
                <td>
                    Unique Device Name
                </td>
                <td>
                    <input type="text" class="form-control" value="{{ defaultName }}" id="probeDeviceName{{ mode }}" aria-label="Device Name" aria-describedby="device_label" required>
                </td>
                <td>
                    Device name must be unique (not shared with any other devices) and should only contain alpha-numeric characters without spaces.  Used to reference a specific device/port mapping.
                </td>
            </tr>

        </tbody>
	</table>

    <br>
</div>
{% endmacro %}

{% macro render_probe_ports(probe_map, modules, alerts) %}
<div id="probePortsCard">
    {% if alerts != [] %}
    <!-- Alerts -->
    <div id="alerts">
    {% for alert in alerts %}
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
            <strong><i class="fas fa-exclamation-circle"></i>&nbsp; Oops! Something isn't right.</strong><br>
            <i>{{ alert['message'] }}</i>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
        </div>
    {% endfor %}
    </div>
    {% endif %}

    <!-- Port List -->
    <div class="card shadow"> 
        <div class="card-header">
            Probe Configuration
        </div>
        <div class="card-body">
            <table class="table">
                <thead class="thead-light">
                    <tr>
                    <th scope="col">Display Name</th>
                    <th scope="col">Enabled</th>
                    <th scope="col">Type</th>
                    <th scope="col">Device</th>
                    <th scope="col">Port</th>
                    <th scope="col">Profile</th>
                    <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for probe in probe_map['probe_info'] %}
                    <tr>
                        <td class="align-middle">
                            <strong>{{ probe['name'] }}</strong>
                        </td>
                        <td class="align-middle">
                            {% if probe['enabled'] %}<span class="text-success"><i class="far fa-check-circle"></i></span>
                            {% else %}<span class="text-warning"><i class="far fa-times-circle"></i></span>
                            {% endif %}
                        </td>
                        <td class="align-middle">
                            {{ probe['type'] }}
                        </td>
                        <td class="align-middle">
                            {{ probe['device'] }}
                        </td>
                        <td class="align-middle">
                            {{ probe['port'] }}
                        </td>
                        <td class="align-middle">
                            {{ probe['profile']['name'] }}
                        </td>
                        <td class="align-middle" style="width: 20%">
                            <div class="btn-toolbar" role="toolbar">
                                <div class="btn-group mr-2">
                                    <button class="btn btn-primary btn-sm text-white" type="button" data-toggle="modal" data-target="#editProbePortModal" onclick="probe_showProbeConfig('{{ probe['label'] }}')"><i class="far fa-edit"></i></button>
                                </div>
                                <div class="btn-group mr-2">
                                    <button class="btn btn-danger btn-sm text-white" type="button" data-toggle="modal" data-target="#delProbePortModal" onclick="probe_selectProbe('{{ probe['label'] }}')"><i class="far fa-trash-alt"></i></button>
                                </div>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                    <tr>
                        <td class="align-top"></td>
                        <td class="align-top"></td>
                        <td class="align-top"></td>
                        <td class="align-top"></td>
                        <td class="align-top"></td>
                        <td class="align-top"></td>
                        <td class="align-top">
                            <button class="btn btn-success btn-sm text-white" type="button" data-toggle="modal" data-target="#addProbePortModal" onclick="probe_showProbeConfig('')"><i class="fas fa-plus"></i></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Probe Port List Modals -->

    <!-- delProbePortModal -->
    <div class="modal fade" id="delProbePortModal" tabindex="-1" aria-labelledby="delProbePortModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="delProbePortModalLabel">Delete Probe?</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
            Are you sure you want to delete this probe?
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-danger" data-dismiss="modal" onclick="probe_deleteProbe()">Confirm</button>
            </div>
        </div>
        </div>
    </div>

    <!-- editProbePortModal -->
    <div class="modal fade" id="editProbePortModal" tabindex="-1" aria-labelledby="editProbePortModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="editProbePortModalLabel">Edit Probe</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
                <div id="editProbePortField">
                    <!-- Probe Port Configuration Info Here -->
                </div>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" data-dismiss="modal" val="" id="probeEditPortBtn" onclick="probe_submitProbeConfig('edit')">Save</button>
            </div>
        </div>
        </div>
    </div>

    <!-- addProbePortModal -->
    <div class="modal fade" id="addProbePortModal" tabindex="-1" aria-labelledby="addProbePortModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="addProbeDevicePortLabel">Add Probe</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
                <div id="addProbePortField">
                    <!-- Probe Port Configuration Info Here -->
                </div>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="probe_submitProbeConfig('add')">Save</button>
            </div>
        </div>
        </div>
    </div>

</div>

{% endmacro %}

{% macro render_probe_port_settings(defaultLabel, defaultConfig, configOptions) %} 

<table class="table">
    <thead class="thead-light">
        <tr>
        <th scope="col">Setting</th>
        <th scope="col">Options</th>
        <th scope="col">Description</th>
        </tr>
    </thead>
    <tbody>
        <!-- Configuration Items-->
        {% for setting in configOptions %}
        <tr>
            <td>
                {{ configOptions[setting]['display_name'] }}
            </td>
            <td>
                {% if setting == 'name' %} 
                <input type="text" class="form-control probeConfig" value="{{ defaultConfig[setting] }}" id="probe_config_{{ setting }}" required>
                {% else %}
                <select class="form-control probeConfig" id="probe_config_{{ setting }}" name="probe_config_{{ setting }}">
                {% for option in configOptions[setting]['options'] %}
                    <option value="{{ option }}" {% if option == defaultConfig[setting] %}selected{% endif %}>{{ configOptions[setting]['options'][option] }}</option>
                {% endfor %}
                </select>
                {% endif %}
            </td>
            <td>
                {{ configOptions[setting]['description'] | safe }}
            </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

{% endmacro %}